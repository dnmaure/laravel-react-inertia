<?php

namespace Tests\Unit;

use App\Models\{{entity}};
use Illuminate\Foundation\Testing\RefreshDatabase;
use Tests\TestCase;

class {{entity}}Test extends TestCase
{
    use RefreshDatabase;

    public function test_{{entityLower}}_can_be_created(): void
    {
        ${{entityLower}}Data = [
            {{testData}}
        ];

        ${{entityLower}} = {{entity}}::create(${{entityLower}}Data);

        $this->assertInstanceOf({{entity}}::class, ${{entityLower}});
        $this->assertTrue(${{entityLower}}->exists);
        $this->assertNotNull(${{entityLower}}->id);
    }

    public function test_{{entityLower}}_fillable_fields(): void
    {
        ${{entityLower}} = new {{entity}}();
        
        $expectedFillable = [
{{fillableFields}}
        ];

        $this->assertEquals($expectedFillable, ${{entityLower}}->getFillable());
    }

    public function test_{{entityLower}}_can_be_updated(): void
    {
        ${{entityLower}} = {{entity}}::factory()->create();

        $updateData = [
            {{updateData}}
        ];

        ${{entityLower}}->update($updateData);

        ${{entityLower}}->refresh();
        $this->assertEquals($updateData['name'] ?? ${{entityLower}}->name, ${{entityLower}}->name);
        // Verify the record was updated successfully
        $this->assertDatabaseCount('{{entityPluralLower}}', 1);
    }

    public function test_{{entityLower}}_can_be_deleted(): void
    {
        ${{entityLower}} = {{entity}}::factory()->create();
        ${{entityLower}}Id = ${{entityLower}}->id;

        ${{entityLower}}->delete();

        $this->assertDatabaseMissing('{{entityPluralLower}}', ['id' => ${{entityLower}}Id]);
    }
}
